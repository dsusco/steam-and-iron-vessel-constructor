import{R as S,b as W,c as C,D as _,P as F,W as A,a as E,d as q,u as M}from"./weapon-offensive-potential-4d44619b.js";import{u as G,_ as I}from"./eccentricities-4e8d5293.js";import{d as h,w as k,e as x,o as i,c as m,a as t,b,F as v,r as y,t as f,u as o,l as N,g as O,j as w,k as P}from"./index-958affa3.js";import{_ as D}from"./_plugin-vue_export-helper-c27b6911.js";function j(a,u,l,p,s){const d=h(null),n=h(null);return k(()=>{const e=u.value?+u.value.minimumRange-1:+a.value;d.value=Array.from({length:Math.abs(e-+p.value)+1},(B,U)=>U+ +p.value)}),k(()=>{const e=l.value?+l.value.maximumRange+1:+S[0];n.value=Array.from({length:Math.abs(+s.value-e)+1},(B,U)=>U+e)}),{maximumRangeGamut:d,minimumRangeGamut:n}}const V=t("legend",null,"Range Band",-1),Y=["value"],L=["value"],z=["value"],H=["value"],J=["value"],K=["value"],Q={__name:"WeaponRangeBand",props:{index:{type:Number,required:!0},maximumWeaponRange:{type:Number,required:!0},nextRangeBand:Object,prevRangeBand:Object,minimumRange:{type:String,required:!0},maximumRange:{type:String,required:!0},rateOfFire:{type:String,required:!0},accuracy:{type:String,required:!0},damage:{type:String,required:!0},penetration:{type:String,required:!0}},emits:["remove:rangeBand","update:minimumRange","update:maximumRange","update:rateOfFire","update:accuracy","update:damage","update:penetration"],setup(a,{emit:u}){const l=a,{maximumRangeGamut:p,minimumRangeGamut:s}=j(x(l,"maximumWeaponRange"),x(l,"nextRangeBand"),x(l,"prevRangeBand"),x(l,"minimumRange"),x(l,"maximumRange"));return(d,n)=>(i(),m("fieldset",null,[V,t("label",null,[b(" Minimum Range "),t("select",{value:a.minimumRange,onChange:n[0]||(n[0]=e=>u("update:minimumRange",e.target.value))},[(i(!0),m(v,null,y(o(s),e=>(i(),m("option",{key:e},f(e),1))),128))],40,Y)]),t("label",null,[b(" Maximum Range "),t("select",{value:a.maximumRange,onChange:n[1]||(n[1]=e=>u("update:maximumRange",e.target.value))},[(i(!0),m(v,null,y(o(p),e=>(i(),m("option",{key:e},f(e),1))),128))],40,L)]),t("label",null,[b(" Rate of Fire "),t("select",{value:a.rateOfFire,onChange:n[2]||(n[2]=e=>u("update:rateOfFire",e.target.value))},[(i(!0),m(v,null,y(o(W),e=>(i(),m("option",{key:e},f(e),1))),128))],40,z)]),t("label",null,[b(" Accuracy "),t("select",{value:a.accuracy,onChange:n[3]||(n[3]=e=>u("update:accuracy",e.target.value))},[(i(!0),m(v,null,y(o(C),e=>(i(),m("option",{key:e},f(e),1))),128))],40,H)]),t("label",null,[b(" Damage "),t("select",{value:a.damage,onChange:n[4]||(n[4]=e=>u("update:damage",e.target.value))},[(i(!0),m(v,null,y(o(_),e=>(i(),m("option",{key:e},f(e),1))),128))],40,J)]),t("label",null,[b(" Penetration "),t("select",{value:a.penetration,onChange:n[5]||(n[5]=e=>u("update:penetration",e.target.value))},[(i(!0),m(v,null,y(o(F),e=>(i(),m("option",{key:e},f(e),1))),128))],40,K)]),t("button",{type:"button",onClick:n[6]||(n[6]=e=>u("remove:rangeBand",a.index))},"×")]))}};class X{constructor(u=S[0]){this.minimumRange=`${u}`,this.maximumRange=`${u}`,this.rateOfFire=W[0],this.accuracy=C[0],this.damage=_[0],this.penetration=F[0]}}function Z(a,u){const l=h(null);function p(){const d=l.value;d&&u.value.push(new X(d))}function s(d){u.value.splice(+d,1)}return k(()=>{let d=Math.max(0,...u.value.map(n=>+n.maximumRange))+1;(u.value.length>2||d>A[a.value].maximumRange)&&(d=!1),l.value=d}),{addRangeBand:p,nextMinimumRange:l,removeRangeBand:s}}const $=a=>(w("data-v-7779febc"),a=a(),P(),a),ee={class:"weapon"},ae=["value"],ne=["disabled","value"],te={class:"weapon_range_bands"},ue=$(()=>t("legend",null,"Range Bands",-1)),ie=["disabled"],re={class:"weapon_eccentricities"},me=$(()=>t("legend",null,"Eccentricities",-1)),le={__name:"Weapon",props:{id:{type:String,required:!0},name:{type:String,required:!0},type:{type:String,required:!0},rangeBands:{type:Array,required:!0},eccentricities:{type:Array,required:!0}},emits:["remove:weapon","update:name","update:type"],setup(a,{emit:u}){const l=a,{enabledEccentricities:p,toggleEccentricity:s}=G(N(l),E.Weapon),{weaponOffensivePotential:d}=q(x(l,"rangeBands"),x(l,"eccentricities")),{addRangeBand:n,nextMinimumRange:e,removeRangeBand:B}=Z(x(l,"type"),x(l,"rangeBands"));return(U,R)=>(i(),m("fieldset",ee,[t("legend",null,f(a.name||a.id),1),t("label",null,[b(" Name "),t("input",{value:a.name,onInput:R[0]||(R[0]=r=>u("update:name",r.target.value))},null,40,ae)]),t("label",null,[b(" Type "),t("select",{disabled:a.rangeBands.length||a.eccentricities.length,value:a.type,onChange:R[1]||(R[1]=r=>u("update:type",r.target.value))},[(i(!0),m(v,null,y(o(A),(r,g)=>(i(),m("option",{key:g},f(g),1))),128))],40,ne)]),t("button",{type:"button",onClick:R[2]||(R[2]=r=>u("remove:weapon",a.id))},"×"),t("span",null,"OP: "+f(o(d)),1),t("fieldset",te,[ue,t("button",{disabled:!o(e),onClick:R[3]||(R[3]=r=>o(n)())},"Add Range Band",8,ie),(i(!0),m(v,null,y(a.rangeBands,(r,g)=>(i(),O(Q,{key:g,index:g,maximumWeaponRange:o(A)[a.type].maximumRange,nextRangeBand:a.rangeBands[g+1],prevRangeBand:a.rangeBands[g-1],minimumRange:r.minimumRange,"onUpdate:minimumRange":c=>r.minimumRange=c,maximumRange:r.maximumRange,"onUpdate:maximumRange":c=>r.maximumRange=c,rateOfFire:r.rateOfFire,"onUpdate:rateOfFire":c=>r.rateOfFire=c,accuracy:r.accuracy,"onUpdate:accuracy":c=>r.accuracy=c,damage:r.damage,"onUpdate:damage":c=>r.damage=c,penetration:r.penetration,"onUpdate:penetration":c=>r.penetration=c,"onRemove:rangeBand":c=>o(B)(c)},null,8,["index","maximumWeaponRange","nextRangeBand","prevRangeBand","minimumRange","onUpdate:minimumRange","maximumRange","onUpdate:maximumRange","rateOfFire","onUpdate:rateOfFire","accuracy","onUpdate:accuracy","damage","onUpdate:damage","penetration","onUpdate:penetration","onRemove:rangeBand"]))),128))]),t("fieldset",re,[me,(i(!0),m(v,null,y(o(E).Weapon,(r,g)=>(i(),O(I,{key:g,abbr:g,checked:a.eccentricities.includes(g),disabled:!o(p)[g],eccentricity:r,"onUpdate:eccentricity":R[4]||(R[4]=(c,T)=>o(s)(c,T))},null,8,["abbr","checked","disabled","eccentricity"]))),128))])]))}},oe=D(le,[["__scopeId","data-v-7779febc"]]),pe={__name:"WeaponsView",setup(a){const u=M();return(l,p)=>(i(),m("main",null,[t("div",null,[t("button",{onClick:p[0]||(p[0]=s=>o(u).addWeapon())},"Add Weapon")]),(i(!0),m(v,null,y(o(u).weapons,(s,d)=>(i(),O(oe,{key:d,id:d,name:s.name,"onUpdate:name":n=>s.name=n,type:s.type,"onUpdate:type":n=>s.type=n,rangeBands:s.rangeBands,"onUpdate:rangeBands":n=>s.rangeBands=n,eccentricities:s.eccentricities,"onUpdate:eccentricities":n=>s.eccentricities=n,"onRemove:weapon":n=>o(u).removeWeapon(n)},null,8,["id","name","onUpdate:name","type","onUpdate:type","rangeBands","onUpdate:rangeBands","eccentricities","onUpdate:eccentricities","onRemove:weapon"]))),128))]))}};export{pe as default};
