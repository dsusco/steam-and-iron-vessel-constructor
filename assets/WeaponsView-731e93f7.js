import{d as A,w as h,e as b,o as i,c as l,a as n,b as U,F as v,r as y,t as x,u as o,l as q,g as k,j as M,k as G,s as I}from"./index-638e277d.js";import{R as S,b as W,c as C,D as _,P as F,W as O,a as E,d as N,u as w}from"./weapon-offensive-potential-6f513e80.js";import{u as P,_ as D}from"./eccentricities-5dee32a3.js";import{_ as j}from"./_plugin-vue_export-helper-c27b6911.js";function V(a,t,m,p,f){const s=A(null),u=A(null);return h(()=>{const e=t.value?+t.value.minimumRange-1:+a.value;s.value=Array.from({length:Math.abs(e-+p.value)+1},(B,c)=>c+ +p.value)}),h(()=>{const e=m.value?+m.value.maximumRange+1:+S[0];u.value=Array.from({length:Math.abs(+f.value-e)+1},(B,c)=>c+e)}),{maximumRangeGamut:s,minimumRangeGamut:u}}const Y=n("legend",null,"Range Band",-1),L=["value"],z=["value"],H=["value"],J=["value"],K=["value"],Q=["value"],X={__name:"WeaponRangeBand",props:{index:{type:Number,required:!0},maximumWeaponRange:{type:Number,required:!0},nextRangeBand:Object,prevRangeBand:Object,minimumRange:{type:String,required:!0},maximumRange:{type:String,required:!0},rateOfFire:{type:String,required:!0},accuracy:{type:String,required:!0},damage:{type:String,required:!0},penetration:{type:String,required:!0}},emits:["remove:rangeBand","update:minimumRange","update:maximumRange","update:rateOfFire","update:accuracy","update:damage","update:penetration"],setup(a,{emit:t}){const m=a,{maximumRangeGamut:p,minimumRangeGamut:f}=V(b(m,"maximumWeaponRange"),b(m,"nextRangeBand"),b(m,"prevRangeBand"),b(m,"minimumRange"),b(m,"maximumRange"));return(s,u)=>(i(),l("fieldset",null,[Y,n("label",null,[U(" Minimum Range "),n("select",{value:a.minimumRange,onChange:u[0]||(u[0]=e=>t("update:minimumRange",e.target.value))},[(i(!0),l(v,null,y(o(f),e=>(i(),l("option",{key:e},x(e),1))),128))],40,L)]),n("label",null,[U(" Maximum Range "),n("select",{value:a.maximumRange,onChange:u[1]||(u[1]=e=>t("update:maximumRange",e.target.value))},[(i(!0),l(v,null,y(o(p),e=>(i(),l("option",{key:e},x(e),1))),128))],40,z)]),n("label",null,[U(" Rate of Fire "),n("select",{value:a.rateOfFire,onChange:u[2]||(u[2]=e=>t("update:rateOfFire",e.target.value))},[(i(!0),l(v,null,y(o(W),e=>(i(),l("option",{key:e},x(e),1))),128))],40,H)]),n("label",null,[U(" Accuracy "),n("select",{value:a.accuracy,onChange:u[3]||(u[3]=e=>t("update:accuracy",e.target.value))},[(i(!0),l(v,null,y(o(C),e=>(i(),l("option",{key:e},x(e),1))),128))],40,J)]),n("label",null,[U(" Damage "),n("select",{value:a.damage,onChange:u[4]||(u[4]=e=>t("update:damage",e.target.value))},[(i(!0),l(v,null,y(o(_),e=>(i(),l("option",{key:e},x(e),1))),128))],40,K)]),n("label",null,[U(" Penetration "),n("select",{value:a.penetration,onChange:u[5]||(u[5]=e=>t("update:penetration",e.target.value))},[(i(!0),l(v,null,y(o(F),e=>(i(),l("option",{key:e},x(e),1))),128))],40,Q)]),n("button",{type:"button",onClick:u[6]||(u[6]=e=>t("remove:rangeBand",a.index))},"×")]))}};class Z{constructor(t=S[0]){this.minimumRange=`${t}`,this.maximumRange=`${t}`,this.rateOfFire=W[0],this.accuracy=C[0],this.damage=_[0],this.penetration=F[0]}}function ee(a,t){const m=A(null);function p(){const s=m.value;s&&t.value.push(new Z(s))}function f(s){t.value.splice(+s,1)}return h(()=>{let s=Math.max(0,...t.value.map(u=>+u.maximumRange))+1;(t.value.length>2||s>O[a.value].maximumRange)&&(s=!1),m.value=s}),{addRangeBand:p,nextMinimumRange:m,removeRangeBand:f}}const $=a=>(M("data-v-7779febc"),a=a(),G(),a),ae={class:"weapon"},ne=["value"],te=["disabled","value"],ue={class:"weapon_range_bands"},ie=$(()=>n("legend",null,"Range Bands",-1)),re=["disabled"],me={class:"weapon_eccentricities"},le=$(()=>n("legend",null,"Eccentricities",-1)),oe={__name:"Weapon",props:{id:{type:String,required:!0},name:{type:String,required:!0},type:{type:String,required:!0},rangeBands:{type:Array,required:!0},eccentricities:{type:Array,required:!0}},emits:["remove:weapon","update:name","update:type"],setup(a,{emit:t}){const m=a,{enabledEccentricities:p,toggleEccentricity:f}=P(q(m),E.Weapon),{weaponOffensivePotential:s}=N(b(m,"rangeBands"),b(m,"eccentricities")),{addRangeBand:u,nextMinimumRange:e,removeRangeBand:B}=ee(b(m,"type"),b(m,"rangeBands"));return(c,R)=>(i(),l("fieldset",ae,[n("legend",null,x(a.name||a.id),1),n("label",null,[U(" Name "),n("input",{value:a.name,onInput:R[0]||(R[0]=r=>t("update:name",r.target.value))},null,40,ne)]),n("label",null,[U(" Type "),n("select",{disabled:a.rangeBands.length||a.eccentricities.length,value:a.type,onChange:R[1]||(R[1]=r=>t("update:type",r.target.value))},[(i(!0),l(v,null,y(o(O),(r,g)=>(i(),l("option",{key:g},x(g),1))),128))],40,te)]),n("button",{type:"button",onClick:R[2]||(R[2]=r=>t("remove:weapon",a.id))},"×"),n("span",null,"OP: "+x(o(s)),1),n("fieldset",ue,[ie,n("button",{disabled:!o(e),onClick:R[3]||(R[3]=r=>o(u)())},"Add Range Band",8,re),(i(!0),l(v,null,y(a.rangeBands,(r,g)=>(i(),k(X,{key:g,index:g,maximumWeaponRange:o(O)[a.type].maximumRange,nextRangeBand:a.rangeBands[g+1],prevRangeBand:a.rangeBands[g-1],minimumRange:r.minimumRange,"onUpdate:minimumRange":d=>r.minimumRange=d,maximumRange:r.maximumRange,"onUpdate:maximumRange":d=>r.maximumRange=d,rateOfFire:r.rateOfFire,"onUpdate:rateOfFire":d=>r.rateOfFire=d,accuracy:r.accuracy,"onUpdate:accuracy":d=>r.accuracy=d,damage:r.damage,"onUpdate:damage":d=>r.damage=d,penetration:r.penetration,"onUpdate:penetration":d=>r.penetration=d,"onRemove:rangeBand":d=>o(B)(d)},null,8,["index","maximumWeaponRange","nextRangeBand","prevRangeBand","minimumRange","onUpdate:minimumRange","maximumRange","onUpdate:maximumRange","rateOfFire","onUpdate:rateOfFire","accuracy","onUpdate:accuracy","damage","onUpdate:damage","penetration","onUpdate:penetration","onRemove:rangeBand"]))),128))]),n("fieldset",me,[le,(i(!0),l(v,null,y(o(E).Weapon,(r,g)=>(i(),k(D,{key:g,abbr:g,checked:a.eccentricities.includes(g),disabled:!o(p)[g],eccentricity:r,"onUpdate:eccentricity":R[4]||(R[4]=(d,T)=>o(f)(d,T))},null,8,["abbr","checked","disabled","eccentricity"]))),128))])]))}},se=j(oe,[["__scopeId","data-v-7779febc"]]),Re={__name:"WeaponsView",setup(a){const t=w(),{addWeapon:m,removeWeapon:p}=t,{weapons:f}=I(t);return(s,u)=>(i(),l("main",null,[n("div",null,[n("button",{onClick:u[0]||(u[0]=e=>o(m)())},"Add Weapon")]),(i(!0),l(v,null,y(o(f),(e,B)=>(i(),k(se,{key:B,id:B,name:e.name,"onUpdate:name":c=>e.name=c,type:e.type,"onUpdate:type":c=>e.type=c,rangeBands:e.rangeBands,"onUpdate:rangeBands":c=>e.rangeBands=c,eccentricities:e.eccentricities,"onUpdate:eccentricities":c=>e.eccentricities=c,"onRemove:weapon":c=>o(p)(c)},null,8,["id","name","onUpdate:name","type","onUpdate:type","rangeBands","onUpdate:rangeBands","eccentricities","onUpdate:eccentricities","onRemove:weapon"]))),128))]))}};export{Re as default};
