import{d as k,w as A,e as b,o as u,c as r,a as n,b as B,F as p,r as R,t as x,u as o,l as q,g as h,j as M,k as G,s as I}from"./index-1f403647.js";import{R as S,b as W,c as C,D as _,P as F,W as O,a as E,d as N,u as w}from"./weapon-offensive-potential-e6206dbb.js";import{u as P,_ as D}from"./eccentricities-4d7272af.js";import{_ as j}from"./_plugin-vue_export-helper-c27b6911.js";function V(a,t,m,v,y){const s=k(null),i=k(null);return A(()=>{const e=t.value?+t.value.minimumRange-1:+a.value;s.value=Array.from({length:Math.abs(e-+v.value)+1},(U,c)=>c+ +v.value)}),A(()=>{const e=m.value?+m.value.maximumRange+1:+S[0];i.value=Array.from({length:Math.abs(+y.value-e)+1},(U,c)=>c+e)}),{maximumRangeGamut:s,minimumRangeGamut:i}}const Y=n("legend",null,"Range Band",-1),L=["value"],z=["value"],H=["value"],J=["value"],K=["value"],Q=["value"],X={__name:"WeaponRangeBand",props:{index:{type:Number,required:!0},maximumWeaponRange:{type:Number,required:!0},nextRangeBand:Object,prevRangeBand:Object,minimumRange:{type:String,required:!0},maximumRange:{type:String,required:!0},rateOfFire:{type:String,required:!0},accuracy:{type:String,required:!0},damage:{type:String,required:!0},penetration:{type:String,required:!0}},emits:["remove:rangeBand","update:minimumRange","update:maximumRange","update:rateOfFire","update:accuracy","update:damage","update:penetration"],setup(a,{emit:t}){const m=a,{maximumRangeGamut:v,minimumRangeGamut:y}=V(b(m,"maximumWeaponRange"),b(m,"nextRangeBand"),b(m,"prevRangeBand"),b(m,"minimumRange"),b(m,"maximumRange"));return(s,i)=>(u(),r("fieldset",null,[Y,n("label",null,[B(" Minimum Range "),n("select",{value:a.minimumRange,onChange:i[0]||(i[0]=e=>t("update:minimumRange",e.target.value))},[(u(!0),r(p,null,R(o(y),e=>(u(),r("option",{key:e},x(e),1))),128))],40,L)]),n("label",null,[B(" Maximum Range "),n("select",{value:a.maximumRange,onChange:i[1]||(i[1]=e=>t("update:maximumRange",e.target.value))},[(u(!0),r(p,null,R(o(v),e=>(u(),r("option",{key:e},x(e),1))),128))],40,z)]),n("label",null,[B(" Rate of Fire "),n("select",{value:a.rateOfFire,onChange:i[2]||(i[2]=e=>t("update:rateOfFire",e.target.value))},[(u(!0),r(p,null,R(o(W),e=>(u(),r("option",{key:e},x(e),1))),128))],40,H)]),n("label",null,[B(" Accuracy "),n("select",{value:a.accuracy,onChange:i[3]||(i[3]=e=>t("update:accuracy",e.target.value))},[(u(!0),r(p,null,R(o(C),e=>(u(),r("option",{key:e},x(e),1))),128))],40,J)]),n("label",null,[B(" Damage "),n("select",{value:a.damage,onChange:i[4]||(i[4]=e=>t("update:damage",e.target.value))},[(u(!0),r(p,null,R(o(_),e=>(u(),r("option",{key:e},x(e),1))),128))],40,K)]),n("label",null,[B(" Penetration "),n("select",{value:a.penetration,onChange:i[5]||(i[5]=e=>t("update:penetration",e.target.value))},[(u(!0),r(p,null,R(o(F),e=>(u(),r("option",{key:e},x(e),1))),128))],40,Q)]),n("button",{type:"button",onClick:i[6]||(i[6]=e=>t("remove:rangeBand",a.index))},"×")]))}};class Z{constructor(t=S[0]){this.minimumRange=`${t}`,this.maximumRange=`${t}`,this.rateOfFire=W[0],this.accuracy=C[0],this.damage=_[0],this.penetration=F[0]}}function ee(a,t){const m=k(null);function v(){const s=m.value;s&&t.value.push(new Z(s))}function y(s){t.value.splice(+s,1)}return A(()=>{let s=Math.max(0,...t.value.map(i=>+i.maximumRange))+1;(t.value.length>2||s>O[a.value].maximumRange)&&(s=!1),m.value=s}),{addRangeBand:v,nextMinimumRange:m,removeRangeBand:y}}const $=a=>(M("data-v-7779febc"),a=a(),G(),a),ae={class:"weapon"},ne=["value"],te=["disabled","value"],ue={class:"weapon_range_bands"},ie=$(()=>n("legend",null,"Range Bands",-1)),re=["disabled"],le={class:"weapon_eccentricities"},me=$(()=>n("legend",null,"Eccentricities",-1)),oe={__name:"Weapon",props:{id:{type:String,required:!0},name:{type:String,required:!0},type:{type:String,required:!0},rangeBands:{type:Array,required:!0},eccentricities:{type:Array,required:!0}},emits:["remove:weapon","update:name","update:type"],setup(a,{emit:t}){const m=a,{enabledEccentricities:v,toggleEccentricity:y}=P(q(m),E.Weapon),{weaponOffensivePotential:s}=N(b(m,"rangeBands"),b(m,"eccentricities")),{addRangeBand:i,nextMinimumRange:e,removeRangeBand:U}=ee(b(m,"type"),b(m,"rangeBands"));return(c,f)=>(u(),r("fieldset",ae,[n("legend",null,x(a.name||a.id),1),n("label",null,[B(" Name "),n("input",{value:a.name,onInput:f[0]||(f[0]=l=>t("update:name",l.target.value))},null,40,ne)]),n("label",null,[B(" Type "),n("select",{disabled:a.rangeBands.length||a.eccentricities.length,value:a.type,onChange:f[1]||(f[1]=l=>t("update:type",l.target.value))},[(u(!0),r(p,null,R(o(O),(l,g)=>(u(),r("option",{key:g},x(g),1))),128))],40,te)]),n("button",{type:"button",onClick:f[2]||(f[2]=l=>t("remove:weapon",a.id))},"×"),n("span",null,"OP: "+x(o(s)),1),n("fieldset",ue,[ie,n("button",{disabled:!o(e),onClick:f[3]||(f[3]=l=>o(i)())},"Add Range Band",8,re),(u(!0),r(p,null,R(a.rangeBands,(l,g)=>(u(),h(X,{key:g,index:g,maximumWeaponRange:o(O)[a.type].maximumRange,nextRangeBand:a.rangeBands[g+1],prevRangeBand:a.rangeBands[g-1],minimumRange:l.minimumRange,"onUpdate:minimumRange":d=>l.minimumRange=d,maximumRange:l.maximumRange,"onUpdate:maximumRange":d=>l.maximumRange=d,rateOfFire:l.rateOfFire,"onUpdate:rateOfFire":d=>l.rateOfFire=d,accuracy:l.accuracy,"onUpdate:accuracy":d=>l.accuracy=d,damage:l.damage,"onUpdate:damage":d=>l.damage=d,penetration:l.penetration,"onUpdate:penetration":d=>l.penetration=d,"onRemove:rangeBand":d=>o(U)(d)},null,8,["index","maximumWeaponRange","nextRangeBand","prevRangeBand","minimumRange","onUpdate:minimumRange","maximumRange","onUpdate:maximumRange","rateOfFire","onUpdate:rateOfFire","accuracy","onUpdate:accuracy","damage","onUpdate:damage","penetration","onUpdate:penetration","onRemove:rangeBand"]))),128))]),n("fieldset",le,[me,(u(!0),r(p,null,R(o(E).Weapon,(l,g)=>(u(),h(D,{key:g,abbr:g,checked:a.eccentricities.includes(g),disabled:!o(v)[g],eccentricity:l,"onUpdate:eccentricity":f[4]||(f[4]=(d,T)=>o(y)(d,T))},null,8,["abbr","checked","disabled","eccentricity"]))),128))])]))}},se=j(oe,[["__scopeId","data-v-7779febc"]]),Re={__name:"WeaponsView",setup(a){const t=w(),{addWeapon:m,removeWeapon:v}=t,{weapons:y}=I(t);return(s,i)=>(u(),r("main",null,[n("div",null,[n("button",{onClick:i[0]||(i[0]=e=>o(m)())},"Add Weapon")]),(u(!0),r(p,null,R(o(y),(e,U)=>(u(),r("div",{key:U},x(e),1))),128)),(u(!0),r(p,null,R(o(y),(e,U)=>(u(),h(se,{key:U,id:U,name:e.name,"onUpdate:name":c=>e.name=c,type:e.type,"onUpdate:type":c=>e.type=c,rangeBands:e.rangeBands,"onUpdate:rangeBands":c=>e.rangeBands=c,eccentricities:e.eccentricities,"onUpdate:eccentricities":c=>e.eccentricities=c,"onRemove:weapon":c=>o(v)(c)},null,8,["id","name","onUpdate:name","type","onUpdate:type","rangeBands","onUpdate:rangeBands","eccentricities","onUpdate:eccentricities","onRemove:weapon"]))),128))]))}};export{Re as default};
